Управление движением по программной траектории с помощью нейронной сети

В.М. Гриняк, К.С. Шутов, А.В. Артемьев

Владивостокский государственный университет, 
Дальневосточный федеральный университет, 
Морской государственный университет им. адм. Г.И. Невельского, 

Резюме: Работа посвящена созданию аппаратно-программного прототипа 
беспилотного транспортного средства и отработке его аппаратно-программной 
архитектуры в попытке создать универсальное стандартное решение для 
такого типа устройств. Рассматривается задача управления беспилотником 
таким образом, чтобы имелась возможность гибкого переключения источников 
управляющих команд и алгоритмов управления. Для этого подсистемы 
генерации и исполнения управляющих команд предлагается связать посредством 
очереди сообщений, что даёт возможность комбинировать автономный и 
дистанционно управляемый режим работы беспилотника. Предлагается метод 
генерации управляющих команд при следовании объекта по программной траектории, 
основанный на нейронной сети. Входными данными сети являются координаты программной траектории и текущее состояние объекта, а выходными - управляющие воздействия. В работе описывается аппаратная и программная составляющая устройства автомобильного типа, архитектура системы его управления, архитектура нейронной сети, возможные подходы к её обучению. Обсуждается создание обучающей выборки как на моделируемых, так и на реальных данных о движении, что позволяет беспилотному устройству «обучаться» разным стилям вождения. Приводятся результаты экспериментов с различными обучающими выборками, которые демонстрируют практическую применимость предложенного метода управления. Уделено внимание аспектам структуры нейронной сети, включая выбор количества слоев и нейронов. Указано на возможность использования «промежуточных» точек программной траектории для улучшения свойств движения объекта. В целом делается вывод о перспективности применения нейронных сетей в управлении беспилотниками, в тех случаях, когда требуется комбинирование и гибкое переключение алгоритмов управления.


Введение 

На сегодняшний день создание и внедрение беспилотных транспортных средств 
является объектом пристального внимания со стороны исследователей и инженеров. 
Исторически беспилотники создавались в рамках специальных задач и для работы в 
зонах, опасных для человека. В настоящее время имеются попытки их использования 
в самых разных отраслях: видеонаблюдение, доставка больших и мелких грузов, 
сельскохозяйственные работы, мониторинг параметров среды, складские задачи и т.п. 
Соответственно отрасли можно выделить беспилотники наземного, воздушного, 
надводного и подводного типов. 

Наземными беспилотниками автомобильного типа активно занимаются такие компании, 
как Jaguar Land Rоver, Renault-Nissan, General Mоtоrs, Ford, Tesla. Целью их 
разработок является создание автомобиля (в т.ч. большого грузовика), который 
будет способен не только ехать в нужном направлении, но и менять полосы движения, 
самостоятельно пересекать перекрестки и двигаться в пробках [1-3]. Хотя в этой 
отрасли имеются определенные успехи, массовому внедрению беспилотных автомобилей 
мешают невнятная идеология и инфраструктурные ограничения [4, 5].

Из наиболее распространенных малых беспилотных летательных аппаратов (БПЛА), 
ориентированных на взаимодействие с пилотом, можно выделить модели компаний DJI, 
3D Robotics, Walkera, Hubsan, Cheerson и другие [6]. Основным предметом 
научно-исследовательских и опытно-конструкторских изысканий в этой сфере является 
создание новых типов электрических батарей и особо экономичных электродвигателей, 
миниатюризация навесного оборудования, обеспечение надежной связи с удаленным 
оператором [7-10]. 

Наиболее известными рабочими гражданскими проектами в качестве безэкипажных 
научно-исследовательских судов являются C-Enduro Thomas; Datamaran, Salidrone, 
Submaran, Mayflower Autonomous Research Ship (MARS), AAWA, Hronn и другие [11, 12]. Существуют и активно внедряются в повседневную практику все технические предпосылки безэкипажного судоходства: навигационные системы, электронная картография, системы связи, автоматическая идентификационная система (АИС), интеграция навигационных данных (Е-Навигация, А-Навигация), оптические системы наблюдения, автоматические системы управления судном, новые поколения судовых двигателей и источников электроэнергии [13, 14]. Основным направлением исследований в области безэкипажного судоходства является адаптация «под него» классических методов и алгоритмов судовождения, трактовка правил МППСС [15, 16]. 
С точки зрения реализации процессов управления можно выделить 3 режима работы 
беспилотных транспортных средств:
1. полностью автономная система – не предусматривает вмешательство пилота;
2. дистанционно управляемая система – беспилотным объектом управляет оператор, 
не находящийся на борту;
3. комбинированный режим работы – совмещает автономный и дистанционный режимы, 
позволяет оперативно переключаться между ними.

Именно комбинированный режим работы представляет наибольший исследовательский и 
прикладной интерес. Для такого режима важно обеспечить модульность, слабую 
зависимость компонент системы, возможность их заменимости в части функционала, 
связанного с управлением. Это даст возможность эксплуатировать беспилотное 
устройство, оперативно и гибко заменяя алгоритмы управления в зависимости от 
выполняемых им конкретных задач. Хотя имеются безусловные успехи развития 
беспилотников различного типа, на данный момент для комбинированного режима 
работы не отработана архитектура программных компонент управления, нет 
стандартных, устоявшихся архитектурных решений [3]. Таким образом, является 
актуальной задача исследования различных вариантов аппаратно-программной 
архитектуры беспилотных транспортных средств и соответствующих алгоритмов 
управления ими.
Управление движением по программной траектории является традиционной задачей, 
связанной с беспилотными транспортными средствами. В том случае, если такая 
траектория задаётся последовательностью точек (ломаной) возможно множество 
вариантов её реализации, определяемых критериями оптимизации движения и 
спецификой кинематики и динамики объекта. Так, например, объект может 
реализовать траекторию, кратчайшую из возможных, оптимальную по энергетике 
управления, с минимальным числом управляющих воздействий и т.п. В последнее 
время всё чаще отмечаются также решения с критерием подобия: объект должен 
двигаться так, чтобы его движение в автоматическом режиме напоминало бы 
движение в режиме управления человеком. Другими словами, чтобы движение через 
последовательно заданные точки было бы максимально «естественным» и внешне 
автоматически управляемый объект не отличался бы от объекта, управляемого 
опытным оператором. Такой критерий нельзя формализовать и реализовать 
традиционными представлениями теории управления. Популярным подходом к 
решению задач такого типа является использование нейронных сетей. 

Настоящая работа посвящена разработке аппаратно-программного прототипа 
беспилотного транспортного средства, сочетающего комбинированный – автономный и 
дистанционный – режимы работы. При этом автономный режим управления объектом 
реализуется с использованием нейросети, что позволяет реализовать опыт управления,
наработанный оператором (в том числе – и коллективный опыт). Целью работы 
являлась реализация и исследование программной архитектуры, позволяющей 
«на лету» переключать режим управления движением беспилотника и алгоритма 
автономного управления объектом.

Заключение

Работа посвящена задаче создания системы управления движением беспилотным 
транспортным средством, которая обеспечивает возможность гибкого переключения 
алгоритмов управления: с ручного режима на автоматический, с управления 
«с берега» на управление «с борта» и т.п. Предлагается следующая архитектура 
такой системы управления: определяется система команд исполнителя, управляющие 
команды помещаются в очередь сообщений, а затем по мере их обработки извлекаются 
из очереди и исполняются. Это обеспечивает технологическую независимость 
подсистем выработки управляющих команд и подсистем их реализации.

В качестве метода генерации управляющих команд предлагается алгоритм на основе 
нейронной сети. Исходными данными для алгоритма является программная траектория 
объекта. На основе информации о текущем местоположении объекта и его состоянии 
нейронная сеть определяет параметры управления системой, соответствующие 
управляющие команды помещаются в очередь сообщений. В работе рассмотрены 
возможные конфигурации нейронной сети и подходы к её обучению. Приведены 
результаты натурных испытаний, демонстрирующие типичные примеры работы 
предлагаемой системы управления движением.  

Наработанный материал станет базой для дальнейших исследований, на его основе 
будут разрабатываться программно-архитектурные и алгоритмические решения при 
создании беспилотников любого типа: наземных, морских и воздушных.

ЛИТЕРАТУРА

1. Коробеев А.И., Чучаев А.И. Беспилотные транспортные средства: новые вызовы общественной безопасности. Lex Russica (Русский закон). 2019;(2):9–28. 
2. Кулягина Е.А., Скоропупова А.В. Цифровая логистика: перспективы и проблемы развития в России. Устойчивое экономическое развитие: проблемы и перспективы. 2022;(1):140–144.
3. Покусаев О.Н., Куприяновский В.П., Катцын Д.В., Намиот Д.Е. Онтологии и безопасность автономных (беспилотных) автомобилей. International Journal of Open Information Technologies. 2019;7(2):81–93.
4. Гусев С.И., Епифанов В.В. Проблемы внедрения беспилотных автомобилей в экономическую среду. Вестник Ульяновского государственного технического университета. 2021;(1):44–49.
5. Кисуленко Б.В. Безопасность автоматизированных/беспилотных автомобилей и её оценка при допуске к эксплуатации. Автомобильная промышленность. 2022;(2):7–13.
6. Бондарев А.Н., Киричек Р.В. Обзор беспилотных летательных аппаратов общего пользования и регулирования воздушного движения БПЛА в разных странах. Информационные технологии и телекоммуникации. 2016;4(4):13–23.
7. Афонин И.Л, Иевлев К.В., Атяшкин Д.В. Система идентификации гражданских беспилотных летательных аппаратов. Современные проблемы радиоэлектроники и телекоммуникаций. 2019;(2):41.
8. Меркулов Г.А., Павлова Н.В. Программно-алгоритмическое обеспечение бортового вычислительного комплекса беспилотного летательного аппарата гражданского назначения. Автоматизация и IT в энергетике. 2017;(8):26–33.
9. Матюха С.В. Анализ перспективы использования беспилотных летательных аппаратов в авиаперевозках. Транспортное дело России. 2021;(3):26–27. 
10. Попов А.С., Усмонов Е.М., Сухачев Н.В. Способ навигации беспилотных летательных аппаратов на основе системы технического зрения. Транспорт: наука, техника, управление. Научный информационный сборник. 2022;(2):11–19. 
11. Кириллова М.А., Рожко А.И. Перспективы развития безэкипажных судов в Российской Федерации. Вестник Астраханского государственного технического университета. Серия: Морская техника и технология. 2020;(3):16–22. 
12. Епихин А.И., Игнатенко А.В., Студеникин Д.Е., Хекерт Е.В. Основные тренды внедрения технологий искусственного интеллекта в управлении морскими автономными надводными судами. Эксплуатация морского транспорта. 2021;(1):88–96. 
13. Ардельянов Н.П. Промежуточные результаты концепции е-навигации. Вестник государственного морского университета имени адмирала Ф.Ф. Ушакова. 2022;(2):8–11.
14. Ривкин Б.С. Е-навигация. Прошло 5 лет. Гироскопия и навигация. 2020;28(1):101–120. 
15. Коренев А.С., Хабаров С.П., Шпекторов А.Г. Формирование траекторий движения безэкипажного судна. Морские интеллектуальные технологии. 2021;(4-1):158–165. 
16. Дыда А.А., Пушкарев И.И., Чумакова К.Н. Алгоритм обхода статических препятствий для безэкипажного судна. Вестник государственного университета морского и речного флота им. адмирала С.О. Макарова. 2021;13(3):307–315. 
17. Thomas A.J., Petridis M., Walters S.D., Gheytassi S.M., Morgan R.E. Two Hidden Layers are Usually Better than One. Engineering Applications of Neural Networks. Communications in Computer and Information Science. 2017;744:279-290.
18. Chu Y., Fei J., Hou S. Adaptive Global Sliding-Mode Control for Dynamic Systems Using Double Hidden Layer Recurrent Neural Network Structure. IEEE Transactions on Neural Networks and Learning Systems. 2020;31(4):1297–1309. 
19. Jia C., Kong D., Du L. Recursive Terminal Sliding-Mode Control Method for Nonlinear System Based on Double Hidden Layer Fuzzy Emotional Recurrent Neural Network. IEEE Access. 2022;10:118012–118023. 
20. Гриняк В.М., Девятисильный А.С., Люлько В.И., Цыбанов П.А. Возможности позиционирования внутри помещений с помощью Bluetooth устройств. Моделирование, оптимизация и информационные технологии. 2018;6(2):132–143.
21. Дыда А.А., Нгуен В.Т., Оськин Д.А. Система управления курсом судна с компенсацией действия внешних возмущений на работу рулевой машины. Вестник Астраханского государственного технического университета. Серия: Морская техника и технология. 2021;(4):34–42.

